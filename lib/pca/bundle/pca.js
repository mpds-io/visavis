'use strict';(function(ma){typeof exports==="object"&&typeof module!=="undefined"?module.exports=ma():typeof define==="function"&&define.amd?define([],ma):(typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:this).mlPca=ma()})(function(){var ma;return function H(Z,ha,d){function ia(U,T){if(!ha[U]){if(!Z[U]){var V=typeof require=="function"&&require;if(!T&&V)return V(U,true);if(da)return da(U,true);T=Error("Cannot find module '"+U+"'");throw T.code=
"MODULE_NOT_FOUND",T;}T=ha[U]={exports:{}};Z[U][0].call(T.exports,function(d){var m=Z[U][1][d];return ia(m?m:d)},T,T.exports,H,Z,ha,d)}return ha[U].exports}for(var da=typeof require=="function"&&require,V=0;V<d.length;V++)ia(d[V]);return ia}({1:[function(Z,ha,d){function H(d,a){if(Math.abs(d)>Math.abs(a)){var c=a/d;return Math.abs(d)*Math.sqrt(1+c*c)}if(a!==0){c=d/a;return Math.abs(a)*Math.sqrt(1+c*c)}return 0}function ia(d,a,c){for(var f=Array(d),e=0;e<d;e++){f[e]=Array(a);for(var b=0;b<a;b++)f[e][b]=
c}return f}function da(d,a,c){d=c?d.rows:d.rows-1;if(a<0||a>d)throw new RangeError("Row index out of range");}function V(d,a,c){d=c?d.columns:d.columns-1;if(a<0||a>d)throw new RangeError("Column index out of range");}function U(d,a){a.to1DArray&&(a=a.to1DArray());if(a.length!==d.columns)throw new RangeError("vector size must be the same as the number of columns");return a}function T(d,a){a.to1DArray&&(a=a.to1DArray());if(a.length!==d.rows)throw new RangeError("vector size must be the same as the number of rows");
return a}function ka(d,a,c){return{row:x(d,a),column:m(d,c)}}function x(d,a){if(typeof a!=="object")throw new TypeError("unexpected type for row indices");if(a.some((a)=>a<0||a>=d.rows))throw new RangeError("row indices are out of range");Array.isArray(a)||(a=Array.from(a));return a}function m(d,a){if(typeof a!=="object")throw new TypeError("unexpected type for column indices");if(a.some((a)=>a<0||a>=d.columns))throw new RangeError("column indices are out of range");Array.isArray(a)||(a=Array.from(a));
return a}function P(d,a,c,f,e){if(arguments.length!==5)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(a){return typeof a!=="number"}))throw new TypeError("Invalid argument type");if(a>c||f>e||a<0||a>=d.rows||c<0||c>=d.rows||f<0||f>=d.columns||e<0||e>=d.columns)throw new RangeError("Submatrix indices are out of range");}function J(d){for(var a=K.zeros(d.rows,1),c=0;c<d.rows;++c)for(var f=0;f<d.columns;++f)a.set(c,0,a.get(c,0)+d.get(c,f));return a}function W(d){for(var a=
K.zeros(1,d.columns),c=0;c<d.rows;++c)for(var f=0;f<d.columns;++f)a.set(0,f,a.get(0,f)+d.get(c,f));return a}function N(d){for(var a=0,c=0;c<d.rows;c++)for(var f=0;f<d.columns;f++)a+=d.get(c,f);return a}function v(d){function a(a,w){return a-w}function c(a,w){for(var p in w)a=a.replace(new RegExp("%"+p+"%","g"),w[p]);return a}d===void 0&&(d=Object);class f extends d{static get [Symbol.species](){return this}static from1DArray(a,w,b){if(a*w!==b.length)throw new RangeError("Data length does not match given dimensions");
for(var p=new this(a,w),c=0;c<a;c++)for(var ea=0;ea<w;ea++)p.set(c,ea,b[c*w+ea]);return p}static rowVector(a){for(var w=new this(1,a.length),p=0;p<a.length;p++)w.set(0,p,a[p]);return w}static columnVector(a){for(var p=new this(a.length,1),b=0;b<a.length;b++)p.set(b,0,a[b]);return p}static empty(a,b){return new this(a,b)}static zeros(a,b){return this.empty(a,b).fill(0)}static ones(a,b){return this.empty(a,b).fill(1)}static rand(a,b,c){if(c===void 0)c=Math.random;for(var p=this.empty(a,b),w=0;w<a;w++)for(var ea=
0;ea<b;ea++)p.set(w,ea,c());return p}static randInt(a,b,c,e){c===void 0&&(c=1E3);if(e===void 0)e=Math.random;for(var p=this.empty(a,b),w=0;w<a;w++)for(var ea=0;ea<b;ea++){var f=Math.floor(e()*c);p.set(w,ea,f)}return p}static eye(a,b,c){b===void 0&&(b=a);c===void 0&&(c=1);var p=Math.min(a,b);a=this.zeros(a,b);for(b=0;b<p;b++)a.set(b,b,c);return a}static diag(a,b,c){var p=a.length;b===void 0&&(b=p);c===void 0&&(c=b);p=Math.min(p,b,c);b=this.zeros(b,c);for(c=0;c<p;c++)b.set(c,c,a[c]);return b}static min(a,
b){a=this.checkMatrix(a);b=this.checkMatrix(b);for(var p=a.rows,w=a.columns,c=new this(p,w),e=0;e<p;e++)for(var f=0;f<w;f++)c.set(e,f,Math.min(a.get(e,f),b.get(e,f)));return c}static max(a,b){a=this.checkMatrix(a);b=this.checkMatrix(b);for(var p=a.rows,w=a.columns,c=new this(p,w),e=0;e<p;e++)for(var f=0;f<w;f++)c.set(e,f,Math.max(a.get(e,f),b.get(e,f)));return c}static checkMatrix(a){return f.isMatrix(a)?a:new this(a)}static isMatrix(a){return a!=null&&a.klass==="Matrix"}get size(){return this.rows*
this.columns}apply(a){if(typeof a!=="function")throw new TypeError("callback must be a function");for(var b=this.rows,p=this.columns,c=0;c<b;c++)for(var e=0;e<p;e++)a.call(this,c,e);return this}to1DArray(){for(var a=Array(this.size),b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)a[b*this.columns+c]=this.get(b,c);return a}to2DArray(){for(var a=Array(this.rows),b=0;b<this.rows;b++){a[b]=Array(this.columns);for(var c=0;c<this.columns;c++)a[b][c]=this.get(b,c)}return a}isRowVector(){return this.rows===
1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var a=0;a<this.rows;a++)for(var b=0;b<=a;b++)if(this.get(a,b)!==this.get(b,a))return false;return true}return false}set(a,b,c){throw Error("set method is unimplemented");}get(a,b){throw Error("get method is unimplemented");}repeat(a,b){a=a||1;b=b||1;for(var c=new this.constructor[Symbol.species](this.rows*a,this.columns*b),p=
0;p<a;p++)for(var w=0;w<b;w++)c.setSubMatrix(this,this.rows*p,this.columns*w);return c}fill(a){for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,a);return this}neg(){return this.mulS(-1)}getRow(a){da(this,a);for(var b=Array(this.columns),c=0;c<this.columns;c++)b[c]=this.get(a,c);return b}getRowVector(a){return this.constructor.rowVector(this.getRow(a))}setRow(a,b){da(this,a);b=U(this,b);for(var c=0;c<this.columns;c++)this.set(a,c,b[c]);return this}swapRows(a,b){da(this,a);da(this,
b);for(var c=0;c<this.columns;c++){var p=this.get(a,c);this.set(a,c,this.get(b,c));this.set(b,c,p)}return this}getColumn(a){V(this,a);for(var b=Array(this.rows),c=0;c<this.rows;c++)b[c]=this.get(c,a);return b}getColumnVector(a){return this.constructor.columnVector(this.getColumn(a))}setColumn(a,b){V(this,a);b=T(this,b);for(var c=0;c<this.rows;c++)this.set(c,a,b[c]);return this}swapColumns(a,b){V(this,a);V(this,b);for(var c=0;c<this.rows;c++){var p=this.get(c,a);this.set(c,a,this.get(c,b));this.set(c,
b,p)}return this}addRowVector(a){a=U(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)+a[c]);return this}subRowVector(a){a=U(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)-a[c]);return this}mulRowVector(a){a=U(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)*a[c]);return this}divRowVector(a){a=U(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,
c,this.get(b,c)/a[c]);return this}addColumnVector(a){a=T(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)+a[b]);return this}subColumnVector(a){a=T(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)-a[b]);return this}mulColumnVector(a){a=T(this,a);for(var b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.set(b,c,this.get(b,c)*a[b]);return this}divColumnVector(a){a=T(this,a);for(var b=0;b<this.rows;b++)for(var c=
0;c<this.columns;c++)this.set(b,c,this.get(b,c)/a[b]);return this}mulRow(a,b){da(this,a);for(var c=0;c<this.columns;c++)this.set(a,c,this.get(a,c)*b);return this}mulColumn(a,b){V(this,a);for(var c=0;c<this.rows;c++)this.set(c,a,this.get(c,a)*b);return this}max(){for(var a=this.get(0,0),b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.get(b,c)>a&&(a=this.get(b,c));return a}maxIndex(){for(var a=this.get(0,0),b=[0,0],c=0;c<this.rows;c++)for(var e=0;e<this.columns;e++)if(this.get(c,e)>a){a=this.get(c,
e);b[0]=c;b[1]=e}return b}min(){for(var a=this.get(0,0),b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)this.get(b,c)<a&&(a=this.get(b,c));return a}minIndex(){for(var a=this.get(0,0),b=[0,0],c=0;c<this.rows;c++)for(var e=0;e<this.columns;e++)if(this.get(c,e)<a){a=this.get(c,e);b[0]=c;b[1]=e}return b}maxRow(a){da(this,a);for(var b=this.get(a,0),c=1;c<this.columns;c++)this.get(a,c)>b&&(b=this.get(a,c));return b}maxRowIndex(a){da(this,a);for(var b=this.get(a,0),c=[a,0],e=1;e<this.columns;e++)if(this.get(a,
e)>b){b=this.get(a,e);c[1]=e}return c}minRow(a){da(this,a);for(var b=this.get(a,0),c=1;c<this.columns;c++)this.get(a,c)<b&&(b=this.get(a,c));return b}minRowIndex(a){da(this,a);for(var b=this.get(a,0),c=[a,0],e=1;e<this.columns;e++)if(this.get(a,e)<b){b=this.get(a,e);c[1]=e}return c}maxColumn(a){V(this,a);for(var b=this.get(0,a),c=1;c<this.rows;c++)this.get(c,a)>b&&(b=this.get(c,a));return b}maxColumnIndex(a){V(this,a);for(var b=this.get(0,a),c=[0,a],e=1;e<this.rows;e++)if(this.get(e,a)>b){b=this.get(e,
a);c[0]=e}return c}minColumn(a){V(this,a);for(var b=this.get(0,a),c=1;c<this.rows;c++)this.get(c,a)<b&&(b=this.get(c,a));return b}minColumnIndex(a){V(this,a);for(var b=this.get(0,a),c=[0,a],e=1;e<this.rows;e++)if(this.get(e,a)<b){b=this.get(e,a);c[0]=e}return c}diag(){for(var a=Math.min(this.rows,this.columns),b=Array(a),c=0;c<a;c++)b[c]=this.get(c,c);return b}sum(a){switch(a){case "row":return J(this);case "column":return W(this);default:return N(this)}}mean(){return this.sum()/this.size}prod(){for(var a=
1,b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)a*=this.get(b,c);return a}norm(a="frobenius"){var b=0;if(a==="max")return this.max();if(a==="frobenius"){for(a=0;a<this.rows;a++)for(var c=0;c<this.columns;c++)b+=this.get(a,c)*this.get(a,c);return Math.sqrt(b)}throw new RangeError(`unknown norm type: ${a}`);}cumulativeSum(){for(var a=0,b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++){a+=this.get(b,c);this.set(b,c,a)}return this}dot(a){f.isMatrix(a)&&(a=a.to1DArray());var b=this.to1DArray();
if(b.length!==a.length)throw new RangeError("vectors do not have the same size");for(var c=0,e=0;e<b.length;e++)c+=b[e]*a[e];return c}mmul(a){a=this.constructor.checkMatrix(a);this.columns!==a.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var b=this.rows,c=this.columns,e=a.columns,f=new this.constructor[Symbol.species](b,e),h=Array(c),p=0;p<e;p++){for(var g=0;g<c;g++)h[g]=a.get(g,p);for(var k=0;k<b;k++){var d=0;for(g=0;g<c;g++)d+=this.get(k,
g)*h[g];f.set(k,p,d)}}return f}strassen2x2(a){var b=new this.constructor[Symbol.species](2,2),c=this.get(0,0);const e=a.get(0,0),f=this.get(0,1),h=a.get(0,1),p=this.get(1,0),g=a.get(1,0),k=this.get(1,1);a=a.get(1,1);const d=(c+k)*(e+a),Q=(p+k)*e,m=c*(h-a),x=k*(g-e),r=(c+f)*a,fa=m+r,ja=Q+x;c=d-Q+m+(p-c)*(e+h);b.set(0,0,d+x-r+(f-k)*(g+a));b.set(0,1,fa);b.set(1,0,ja);b.set(1,1,c);return b}strassen3x3(a){var b=new this.constructor[Symbol.species](3,3),c=this.get(0,0);const e=this.get(0,1),f=this.get(0,
2);var h=this.get(1,0),g=this.get(1,1),p=this.get(1,2),k=this.get(2,0),d=this.get(2,1),Q=this.get(2,2);const m=a.get(0,0),x=a.get(0,1),r=a.get(0,2),fa=a.get(1,0),ja=a.get(1,1),q=a.get(1,2),l=a.get(2,0),u=a.get(2,1),z=a.get(2,2),na=(c-h)*(-x+ja),v=(-c+h+g)*(m-x+ja),A=(h+g)*(-m+x);a=c*m;const J=(-c+k+d)*(m-r+q),D=(-c+k)*(r-q),E=(k+d)*(-m+r),P=(-f+d+Q)*(ja+l-u),F=(f-Q)*(ja-u),C=f*l,oa=(d+Q)*(-l+u),N=(-f+g+p)*(q+l-z),G=(f-p)*(q-z),I=(g+p)*(-l+z),K=(c+e+f-h-g-d-Q)*ja+v+A+a+P+C+oa;c=a+J+E+(c+e+f-g-p-k-
d)*q+C+N+I;g=na+g*(-m+x+fa-ja-q-l+z)+v+a+C+N+G;p=na+v+A+a+p*u;h=C+N+G+I+h*r;d=a+J+D+d*(-m+r+fa-ja-q-l+u)+P+F+C;k=P+F+C+oa+k*x;Q=a+J+D+E+Q*z;b.set(0,0,a+C+e*fa);b.set(0,1,K);b.set(0,2,c);b.set(1,0,g);b.set(1,1,p);b.set(1,2,h);b.set(2,0,d);b.set(2,1,k);b.set(2,2,Q);return b}mmulStrassen(a){function b(a,b,c){var e=a.columns;if(a.rows===b&&e===c)return a;b=f.zeros(b,c);return b=b.setSubMatrix(a,0,0)}function c(a,e,h,g){if(h<=512||g<=512)return a.mmul(e);if(h%2===1&&g%2===1){a=b(a,h+1,g+1);e=b(e,h+1,g+
1)}else if(h%2===1){a=b(a,h+1,g);e=b(e,h+1,g)}else if(g%2===1){a=b(a,h,g+1);e=b(e,h,g+1)}var p=parseInt(a.rows/2),k=parseInt(a.columns/2),w=a.subMatrix(0,p-1,0,k-1),n=e.subMatrix(0,p-1,0,k-1),d=a.subMatrix(0,p-1,k,a.columns-1),t=e.subMatrix(0,p-1,k,e.columns-1),B=a.subMatrix(p,a.rows-1,0,k-1),y=e.subMatrix(p,e.rows-1,0,k-1),ea=a.subMatrix(p,a.rows-1,k,a.columns-1),Q=e.subMatrix(p,e.rows-1,k,e.columns-1);a=c(f.add(w,ea),f.add(n,Q),p,k);var m=c(f.add(B,ea),n,p,k);e=c(w,f.sub(t,Q),p,k);var x=c(ea,f.sub(y,
n),p,k),r=c(f.add(w,d),Q,p,k);w=c(f.sub(B,w),f.add(n,t),p,k);k=c(f.sub(d,ea),f.add(y,Q),p,k);p=f.add(a,x);p.sub(r);p.add(k);k=f.add(e,r);x=f.add(m,x);a=f.sub(a,m);a.add(e);a.add(w);e=f.zeros(2*p.rows,2*p.columns);e=e.setSubMatrix(p,0,0);e=e.setSubMatrix(k,p.rows,0);e=e.setSubMatrix(x,0,p.columns);e=e.setSubMatrix(a,p.rows,p.columns);return e.subMatrix(0,h-1,0,g-1)}var e=this.clone(),h=e.rows,g=e.columns,p=a.rows,d=a.columns;g!==p&&console.warn(`Multiplying ${h} x ${g} and ${p} x ${d} matrix: dimensions do not match.`);
h=Math.max(h,p);g=Math.max(g,d);e=b(e,h,g);a=b(a,h,g);return c(e,a,h,g)}scaleRows(a,b){a=a===void 0?0:a;b=b===void 0?1:b;if(a>=b)throw new RangeError("min should be strictly smaller than max");for(var c=this.constructor.empty(this.rows,this.columns),e=0;e<this.rows;e++){var f=I(this.getRow(e),{min:a,max:b});c.setRow(e,f)}return c}scaleColumns(a,b){a=a===void 0?0:a;b=b===void 0?1:b;if(a>=b)throw new RangeError("min should be strictly smaller than max");for(var c=this.constructor.empty(this.rows,this.columns),
e=0;e<this.columns;e++){var f=I(this.getColumn(e),{min:a,max:b});c.setColumn(e,f)}return c}kroneckerProduct(a){a=this.constructor.checkMatrix(a);for(var b=this.rows,c=this.columns,e=a.rows,f=a.columns,h=new this.constructor[Symbol.species](b*e,c*f),g=0;g<b;g++)for(var p=0;p<c;p++)for(var k=0;k<e;k++)for(var d=0;d<f;d++)h[e*g+k][f*p+d]=this.get(g,p)*a.get(k,d);return h}transpose(){for(var a=new this.constructor[Symbol.species](this.columns,this.rows),b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)a.set(c,
b,this.get(b,c));return a}sortRows(b){b===void 0&&(b=a);for(var c=0;c<this.rows;c++)this.setRow(c,this.getRow(c).sort(b));return this}sortColumns(b){b===void 0&&(b=a);for(var c=0;c<this.columns;c++)this.setColumn(c,this.getColumn(c).sort(b));return this}subMatrix(a,b,c,e){P(this,a,b,c,e);for(var f=new this.constructor[Symbol.species](b-a+1,e-c+1),h=a;h<=b;h++)for(var g=c;g<=e;g++)f[h-a][g-c]=this.get(h,g);return f}subMatrixRow(a,b,c){b===void 0&&(b=0);c===void 0&&(c=this.columns-1);if(b>c||b<0||b>=
this.columns||c<0||c>=this.columns)throw new RangeError("Argument out of range");for(var e=new this.constructor[Symbol.species](a.length,c-b+1),f=0;f<a.length;f++)for(var h=b;h<=c;h++){if(a[f]<0||a[f]>=this.rows)throw new RangeError("Row index out of range: "+a[f]);e.set(f,h-b,this.get(a[f],h))}return e}subMatrixColumn(a,b,c){b===void 0&&(b=0);c===void 0&&(c=this.rows-1);if(b>c||b<0||b>=this.rows||c<0||c>=this.rows)throw new RangeError("Argument out of range");for(var e=new this.constructor[Symbol.species](c-
b+1,a.length),f=0;f<a.length;f++)for(var h=b;h<=c;h++){if(a[f]<0||a[f]>=this.columns)throw new RangeError("Column index out of range: "+a[f]);e.set(h-b,f,this.get(h,a[f]))}return e}setSubMatrix(a,b,c){a=this.constructor.checkMatrix(a);P(this,b,b+a.rows-1,c,c+a.columns-1);for(var e=0;e<a.rows;e++)for(var f=0;f<a.columns;f++)this[b+e][c+f]=a.get(e,f);return this}selection(a,b){var c=ka(this,a,b);a=new this.constructor[Symbol.species](a.length,b.length);for(b=0;b<c.row.length;b++)for(var e=c.row[b],
f=0;f<c.column.length;f++)a[b][f]=this.get(e,c.column[f]);return a}trace(){for(var a=Math.min(this.rows,this.columns),b=0,c=0;c<a;c++)b+=this.get(c,c);return b}transposeView(){return new D(this)}rowView(a){da(this,a);return new l(this,a)}columnView(a){V(this,a);return new z(this,a)}flipRowView(){return new O(this)}flipColumnView(){return new ba(this)}subMatrixView(a,b,c,e){return new q(this,a,b,c,e)}selectionView(a,b){return new L(this,a,b)}rowSelectionView(a){return new A(this,a)}columnSelectionView(a){return new R(this,
a)}det(){if(this.isSquare()){if(this.columns===2){var a=this.get(0,0);var b=this.get(0,1);var c=this.get(1,0);var e=this.get(1,1);return a*e-b*c}if(this.columns===3){e=this.selectionView([1,2],[1,2]);var f=this.selectionView([1,2],[0,2]);var h=this.selectionView([1,2],[0,1]);a=this.get(0,0);b=this.get(0,1);c=this.get(0,2);return a*e.det()-b*f.det()+c*h.det()}return(new E(this)).determinant}throw Error("Determinant can only be calculated for a square matrix.");}pseudoInverse(a){if(a===void 0)a=Number.EPSILON;
var b=new G(this,{autoTranspose:true}),c=b.leftSingularVectors,e=b.rightSingularVectors;b=b.diagonal;for(var f=0;f<b.length;f++)b[f]=Math.abs(b[f])>a?1/b[f]:0;b=this.constructor[Symbol.species].diag(b);return e.mmul(b.mmul(c.transposeView()))}clone(){for(var a=new this.constructor[Symbol.species](this.rows,this.columns),b=0;b<this.rows;b++)for(var c=0;c<this.columns;c++)a.set(b,c,this.get(b,c));return a}}f.prototype.klass="Matrix";f.random=f.rand;f.diagonal=f.diag;f.prototype.diagonal=f.prototype.diag;
f.identity=f.eye;f.prototype.negate=f.prototype.neg;f.prototype.tensorProduct=f.prototype.kroneckerProduct;f.prototype.determinant=f.prototype.det;var e=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]];d=eval;for(var b of e){var h=d(c("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",
{name:b[1],op:b[0]})),g=d(c("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:b[1]+"S",op:b[0]})),Q=d(c("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",
{name:b[1]+"M",op:b[0]})),m=d(c("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:b[1]}));for(e=1;e<b.length;e++){f.prototype[b[e]]=h;f.prototype[b[e]+"S"]=g;f.prototype[b[e]+"M"]=Q;f[b[e]]=m}}var x=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(a){x.push(["Math."+
a,a])});for(var fa of x){b=d(c("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:fa[1],method:fa[0]}));h=d(c("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:fa[1]}));for(e=1;e<fa.length;e++){f.prototype[fa[e]]=b;f[fa[e]]=h}}e=[["Math.pow",1,"pow"]];
for(var r of e){b="arg0";for(e=1;e<r[1];e++)b+=`, arg${e}`;if(r[1]!==1){fa=d(c("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:r[2],method:r[0],args:b}));b=d(c("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",{name:r[2],args:b}));
for(e=2;e<r.length;e++){f.prototype[r[e]]=fa;f[r[e]]=b}}else{e={name:r[2],args:b,method:r[0]};fa=d(c("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",e));b=d(c("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",e));h=d(c("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",
e));g=d(c("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",e));for(e=2;e<r.length;e++){f.prototype[r[e]]=fa;f.prototype[r[e]+"M"]=h;f.prototype[r[e]+"S"]=b;f[r[e]]=g}}}return f}function F(d,a,c=false){d=S.checkMatrix(d);a=S.checkMatrix(a);return c?(new G(d)).solve(a):d.isSquare()?(new E(d)).solve(a):(new aa(d)).solve(a)}function C(d,a,c,f){var e,b,h,g;for(h=0;h<d;h++)c[h]=f[d-1][h];for(b=d-1;b>0;b--){for(g=e=
h=0;g<b;g++)h+=Math.abs(c[g]);if(h===0){a[b]=c[b-1];for(h=0;h<b;h++){c[h]=f[b-1][h];f[b][h]=0;f[h][b]=0}}else{for(g=0;g<b;g++){c[g]=c[g]/h;e+=c[g]*c[g]}var Q=c[b-1];var m=Math.sqrt(e);Q>0&&(m=-m);a[b]=h*m;e-=Q*m;c[b-1]=Q-m;for(h=0;h<b;h++)a[h]=0;for(h=0;h<b;h++){Q=c[h];f[h][b]=Q;m=a[h]+f[h][h]*Q;for(g=h+1;g<=b-1;g++){m+=f[g][h]*c[g];a[g]=a[g]+f[g][h]*Q}a[h]=m}for(h=Q=0;h<b;h++){a[h]=a[h]/e;Q+=a[h]*c[h]}Q/=e+e;for(h=0;h<b;h++)a[h]=a[h]-Q*c[h];for(h=0;h<b;h++){Q=c[h];m=a[h];for(g=h;g<=b-1;g++)f[g][h]=
f[g][h]-(Q*a[g]+m*c[g]);c[h]=f[b-1][h];f[b][h]=0}}c[b]=e}for(b=0;b<d-1;b++){f[d-1][b]=f[b][b];f[b][b]=1;e=c[b+1];if(e!==0){for(g=0;g<=b;g++)c[g]=f[g][b+1]/e;for(h=0;h<=b;h++){for(g=m=0;g<=b;g++)m+=f[g][b+1]*f[g][h];for(g=0;g<=b;g++)f[g][h]=f[g][h]-m*c[g]}}for(g=0;g<=b;g++)f[g][b+1]=0}for(h=0;h<d;h++){c[h]=f[d-1][h];f[d-1][h]=0}f[d-1][d-1]=1;a[0]=0}function la(d,a,c,f){var e,b,h,g,Q;for(e=1;e<d;e++)a[e-1]=a[e];var m=a[d-1]=0,x=0,r=Number.EPSILON;for(b=0;b<d;b++){x=Math.max(x,Math.abs(c[b])+Math.abs(a[b]));
for(h=b;h<d;){if(Math.abs(a[h])<=r*x)break;h++}if(h>b){var q=0;do{q+=1;var p=c[b];var w=(c[b+1]-p)/(2*a[b]);var l=H(w,1);w<0&&(l=-l);c[b]=a[b]/(w+l);c[b+1]=a[b]*(w+l);var t=c[b+1];var B=p-c[b];for(e=b+2;e<d;e++)c[e]=c[e]-B;m+=B;w=c[h];var n=g=l=1;var y=a[b+1];var u=Q=0;for(e=h-1;e>=b;e--){n=g;g=l;u=Q;p=l*a[e];B=l*w;l=H(w,a[e]);a[e+1]=Q*l;Q=a[e]/l;l=w/l;w=l*c[e]-Q*p;c[e+1]=B+Q*(l*p+Q*c[e]);for(p=0;p<d;p++){B=f[p][e+1];f[p][e+1]=Q*f[p][e]+l*B;f[p][e]=l*f[p][e]-Q*B}}w=-Q*u*n*y*a[b]/t;a[b]=Q*w;c[b]=l*
w}while(Math.abs(a[b])>r*x)}c[b]=c[b]+m;a[b]=0}for(e=0;e<d-1;e++){p=e;w=c[e];for(a=e+1;a<d;a++)if(c[a]<w){p=a;w=c[a]}if(p!==e){c[p]=c[e];c[e]=w;for(a=0;a<d;a++){w=f[a][e];f[a][e]=f[a][p];f[a][p]=w}}}}function ca(d,a,c,f){var e=d-1,b,h,g;for(g=1;g<=e-1;g++){var Q=0;for(b=g;b<=e;b++)Q+=Math.abs(a[b][g-1]);if(Q!==0){var m=0;for(b=e;b>=g;b--){c[b]=a[b][g-1]/Q;m+=c[b]*c[b]}var x=Math.sqrt(m);c[g]>0&&(x=-x);m-=c[g]*x;c[g]=c[g]-x;for(h=g;h<d;h++){var r=0;for(b=e;b>=g;b--)r+=c[b]*a[b][h];r/=m;for(b=g;b<=
e;b++)a[b][h]=a[b][h]-r*c[b]}for(b=0;b<=e;b++){r=0;for(h=e;h>=g;h--)r+=c[h]*a[b][h];r/=m;for(h=g;h<=e;h++)a[b][h]=a[b][h]-r*c[h]}c[g]=Q*c[g];a[g][g-1]=Q*x}}for(b=0;b<d;b++)for(h=0;h<d;h++)f[b][h]=b===h?1:0;for(g=e-1;g>=1;g--)if(a[g][g-1]!==0){for(b=g+1;b<=e;b++)c[b]=a[b][g-1];for(h=g;h<=e;h++){x=0;for(b=g;b<=e;b++)x+=c[b]*f[b][h];x=x/c[g]/a[g][g-1];for(b=g;b<=e;b++)f[b][h]=f[b][h]+x*c[b]}}}function M(d,a,c,f,e){var b=d-1,h=d-1,g=Number.EPSILON,m=0,x=0,l=0,q=0,u=0,p=0,w=0,z=0,t,B,n,y,v;for(t=0;t<d;t++){if(t<
0||t>h){c[t]=e[t][t];a[t]=0}for(B=Math.max(t-1,0);B<d;B++)x+=Math.abs(e[t][B])}for(;b>=0;){for(n=b;n>0;){p=Math.abs(e[n-1][n-1])+Math.abs(e[n][n]);p===0&&(p=x);if(Math.abs(e[n][n-1])<g*p)break;n--}if(n===b){e[b][b]=e[b][b]+m;c[b]=e[b][b];a[b]=0;b--;z=0}else if(n===b-1){var k=e[b][b-1]*e[b-1][b];l=(e[b-1][b-1]-e[b][b])/2;q=l*l+k;w=Math.sqrt(Math.abs(q));e[b][b]=e[b][b]+m;e[b-1][b-1]=e[b-1][b-1]+m;var X=e[b][b];if(q>=0){w=l>=0?l+w:l-w;c[b-1]=X+w;c[b]=c[b-1];w!==0&&(c[b]=X-k/w);a[b-1]=0;a[b]=0;X=e[b][b-
1];p=Math.abs(X)+Math.abs(w);l=X/p;q=w/p;u=Math.sqrt(l*l+q*q);l/=u;q/=u;for(B=b-1;B<d;B++){w=e[b-1][B];e[b-1][B]=q*w+l*e[b][B];e[b][B]=q*e[b][B]-l*w}for(t=0;t<=b;t++){w=e[t][b-1];e[t][b-1]=q*w+l*e[t][b];e[t][b]=q*e[t][b]-l*w}for(t=0;t<=h;t++){w=f[t][b-1];f[t][b-1]=q*w+l*f[t][b];f[t][b]=q*f[t][b]-l*w}}else{c[b-1]=X+l;c[b]=X+l;a[b-1]=w;a[b]=-w}b-=2;z=0}else{X=e[b][b];k=v=0;if(n<b){v=e[b-1][b-1];k=e[b][b-1]*e[b-1][b]}if(z===10){m+=X;for(t=0;t<=b;t++)e[t][t]=e[t][t]-X;p=Math.abs(e[b][b-1])+Math.abs(e[b-
1][b-2]);X=v=.75*p;k=-.4375*p*p}if(z===30){p=(v-X)/2;p=p*p+k;if(p>0){p=Math.sqrt(p);v<X&&(p=-p);p=X-k/((v-X)/2+p);for(t=0;t<=b;t++)e[t][t]=e[t][t]-p;m+=p;X=v=k=.964}}z+=1;for(y=b-2;y>=n;){w=e[y][y];u=X-w;p=v-w;l=(u*p-k)/e[y+1][y]+e[y][y+1];q=e[y+1][y+1]-w-u-p;u=e[y+2][y+1];p=Math.abs(l)+Math.abs(q)+Math.abs(u);l/=p;q/=p;u/=p;if(y===n)break;if(Math.abs(e[y][y-1])*(Math.abs(q)+Math.abs(u))<g*(Math.abs(l)*(Math.abs(e[y-1][y-1])+Math.abs(w)+Math.abs(e[y+1][y+1]))))break;y--}for(t=y+2;t<=b;t++){e[t][t-
2]=0;t>y+2&&(e[t][t-3]=0)}for(k=y;k<=b-1;k++){var A=k!==b-1;if(k!==y){l=e[k][k-1];q=e[k+1][k-1];u=A?e[k+2][k-1]:0;X=Math.abs(l)+Math.abs(q)+Math.abs(u);if(X!==0){l/=X;q/=X;u/=X}}if(X===0)break;p=Math.sqrt(l*l+q*q+u*u);l<0&&(p=-p);if(p!==0){k!==y?e[k][k-1]=-p*X:n!==y&&(e[k][k-1]=-e[k][k-1]);l+=p;X=l/p;v=q/p;w=u/p;q/=l;u/=l;for(B=k;B<d;B++){l=e[k][B]+q*e[k+1][B];if(A){l+=u*e[k+2][B];e[k+2][B]=e[k+2][B]-l*w}e[k][B]=e[k][B]-l*X;e[k+1][B]=e[k+1][B]-l*v}for(t=0;t<=Math.min(b,k+3);t++){l=X*e[t][k]+v*e[t][k+
1];if(A){l+=w*e[t][k+2];e[t][k+2]=e[t][k+2]-l*u}e[t][k]=e[t][k]-l;e[t][k+1]=e[t][k+1]-l*q}for(t=0;t<=h;t++){l=X*f[t][k]+v*f[t][k+1];if(A){l+=w*f[t][k+2];f[t][k+2]=f[t][k+2]-l*u}f[t][k]=f[t][k]-l;f[t][k+1]=f[t][k+1]-l*q}}}}}if(x!==0){for(b=d-1;b>=0;b--){l=c[b];q=a[b];if(q===0){n=b;e[b][b]=1;for(t=b-1;t>=0;t--){k=e[t][t]-l;u=0;for(B=n;B<=b;B++)u+=e[t][B]*e[B][b];if(a[t]<0){w=k;p=u}else{n=t;if(a[t]===0)e[t][b]=k!==0?-u/k:-u/(g*x);else{X=e[t][t+1];v=e[t+1][t];q=(c[t]-l)*(c[t]-l)+a[t]*a[t];m=(X*p-w*u)/
q;e[t][b]=m;e[t+1][b]=Math.abs(X)>Math.abs(w)?(-u-k*m)/X:(-p-v*m)/w}m=Math.abs(e[t][b]);if(g*m*m>1)for(B=t;B<=b;B++)e[B][b]=e[B][b]/m}}}else if(q<0){n=b-1;if(Math.abs(e[b][b-1])>Math.abs(e[b-1][b])){e[b-1][b-1]=q/e[b][b-1];e[b-1][b]=-(e[b][b]-l)/e[b][b-1]}else{B=r(0,-e[b-1][b],e[b-1][b-1]-l,q);e[b-1][b-1]=B[0];e[b-1][b]=B[1]}e[b][b-1]=0;e[b][b]=1;for(t=b-2;t>=0;t--){z=m=0;for(B=n;B<=b;B++){m+=e[t][B]*e[B][b-1];z+=e[t][B]*e[B][b]}k=e[t][t]-l;if(a[t]<0){w=k;u=m;p=z}else{n=t;if(a[t]===0){B=r(-m,-z,k,
q);e[t][b-1]=B[0];e[t][b]=B[1]}else{X=e[t][t+1];v=e[t+1][t];B=(c[t]-l)*(c[t]-l)+a[t]*a[t]-q*q;y=(c[t]-l)*2*q;B===0&&y===0&&(B=g*x*(Math.abs(k)+Math.abs(q)+Math.abs(X)+Math.abs(v)+Math.abs(w)));B=r(X*u-w*m+q*z,X*p-w*z-q*m,B,y);e[t][b-1]=B[0];e[t][b]=B[1];if(Math.abs(X)>Math.abs(w)+Math.abs(q)){e[t+1][b-1]=(-m-k*e[t][b-1]+q*e[t][b])/X;e[t+1][b]=(-z-k*e[t][b]-q*e[t][b-1])/X}else{B=r(-u-v*e[t][b-1],-p-v*e[t][b],w,q);e[t+1][b-1]=B[0];e[t+1][b]=B[1]}}m=Math.max(Math.abs(e[t][b-1]),Math.abs(e[t][b]));if(g*
m*m>1)for(B=t;B<=b;B++){e[B][b-1]=e[B][b-1]/m;e[B][b]=e[B][b]/m}}}}}for(t=0;t<d;t++)if(t<0||t>h)for(B=t;B<d;B++)f[t][B]=e[t][B];for(B=d-1;B>=0;B--)for(t=0;t<=h;t++){for(k=w=0;k<=Math.min(B,h);k++)w+=f[t][k]*e[k][B];f[t][B]=w}}}function r(d,a,c,f){if(Math.abs(c)>Math.abs(f)){var e=f/c;c+=e*f;return[(d+e*a)/c,(a-e*d)/c]}e=c/f;c=f+e*c;return[(e*d+a)/c,(e*a-d)/c]}Object.defineProperty(d,"__esModule",{value:true});var I=function c(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}(Z("ml-array-rescale"));
if(!Symbol.species)Symbol.species=Symbol.for("@@species");class E{constructor(a){a=S.checkMatrix(a);a=a.clone();var c=a.rows,f=a.columns,e=Array(c),b=1,h,g,d,l;for(h=0;h<c;h++)e[h]=h;var m=Array(c);for(g=0;g<f;g++){for(h=0;h<c;h++)m[h]=a.get(h,g);for(h=0;h<c;h++){var q=Math.min(h,g);for(d=l=0;d<q;d++)l+=a.get(h,d)*m[d];m[h]=m[h]-l;a.set(h,g,m[h])}l=g;for(h=g+1;h<c;h++)Math.abs(m[h])>Math.abs(m[l])&&(l=h);if(l!==g){for(d=0;d<f;d++){h=a.get(l,d);a.set(l,d,a.get(g,d));a.set(g,d,h)}d=e[l];e[l]=e[g];e[g]=
d;b=-b}if(g<c&&a.get(g,g)!==0)for(h=g+1;h<c;h++)a.set(h,g,a.get(h,g)/a.get(g,g))}this.LU=a;this.pivotVector=e;this.pivotSign=b}isSingular(){for(var a=this.LU,c=a.columns,f=0;f<c;f++)if(a[f][f]===0)return true;return false}solve(a){a=K.checkMatrix(a);var c=this.LU;if(c.rows!==a.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");var f=a.columns;a=a.subMatrixRow(this.pivotVector,0,f-1);var e=c.columns,b,h,g;for(g=0;g<e;g++)for(b=g+1;b<e;b++)for(h=
0;h<f;h++)a[b][h]=a[b][h]-a[g][h]*c[b][g];for(g=e-1;g>=0;g--){for(h=0;h<f;h++)a[g][h]=a[g][h]/c[g][g];for(b=0;b<g;b++)for(h=0;h<f;h++)a[b][h]=a[b][h]-a[g][h]*c[b][g]}return a}get determinant(){var a=this.LU;if(!a.isSquare())throw Error("Matrix must be square");for(var c=this.pivotSign,f=a.columns,e=0;e<f;e++)c*=a[e][e];return c}get lowerTriangularMatrix(){for(var a=this.LU,c=a.rows,f=a.columns,e=new K(c,f),b=0;b<c;b++)for(var h=0;h<f;h++)e[b][h]=b>h?a[b][h]:b===h?1:0;return e}get upperTriangularMatrix(){for(var a=
this.LU,c=a.rows,f=a.columns,e=new K(c,f),b=0;b<c;b++)for(var h=0;h<f;h++)e[b][h]=b<=h?a[b][h]:0;return e}get pivotPermutationVector(){return this.pivotVector.slice()}}class G{constructor(a,c={}){a=S.checkMatrix(a);c=a.rows;var f=a.columns,e=Math.min(c,f);const {computeLeftSingularVectors:b=true,computeRightSingularVectors:h=true,autoTranspose:g=false}=c;var d=!!b,l=!!h,m=false;if(c<f)if(g){var q=a.transpose();c=q.rows;f=q.columns;m=true;a=d;d=l;l=a}else{q=a.clone();console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else q=
a.clone();a=Array(Math.min(c+1,f));var x=ia(c,e,0),p=ia(f,f,0),w=Array(f),r=Array(c),t=Math.min(c-1,f),u=Math.max(0,Math.min(f-2,c)),n,y,z;var k=0;for(z=Math.max(t,u);k<z;k++){if(k<t){a[k]=0;for(n=k;n<c;n++)a[k]=H(a[k],q[n][k]);if(a[k]!==0){q[k][k]<0&&(a[k]=-a[k]);for(n=k;n<c;n++)q[n][k]=q[n][k]/a[k];q[k][k]=q[k][k]+1}a[k]=-a[k]}for(y=k+1;y<f;y++){if(k<t&&a[k]!==0){var v=0;for(n=k;n<c;n++)v+=q[n][k]*q[n][y];v=-v/q[k][k];for(n=k;n<c;n++)q[n][y]=q[n][y]+v*q[n][k]}w[y]=q[k][y]}if(d&&k<t)for(n=k;n<c;n++)x[n][k]=
q[n][k];if(k<u){w[k]=0;for(n=k+1;n<f;n++)w[k]=H(w[k],w[n]);if(w[k]!==0){w[k+1]<0&&(w[k]=0-w[k]);for(n=k+1;n<f;n++)w[n]=w[n]/w[k];w[k+1]=w[k+1]+1}w[k]=-w[k];if(k+1<c&&w[k]!==0){for(n=k+1;n<c;n++)r[n]=0;for(y=k+1;y<f;y++)for(n=k+1;n<c;n++)r[n]=r[n]+w[y]*q[n][y];for(y=k+1;y<f;y++){v=-w[y]/w[k+1];for(n=k+1;n<c;n++)q[n][y]=q[n][y]+v*r[n]}}if(l)for(n=k+1;n<f;n++)p[n][k]=w[n]}}r=Math.min(f,c+1);t<f&&(a[t]=q[t][t]);c<r&&(a[r-1]=0);u+1<r&&(w[u]=q[u][r-1]);w[r-1]=0;if(d){for(y=t;y<e;y++){for(n=0;n<c;n++)x[n][y]=
0;x[y][y]=1}for(k=t-1;k>=0;k--)if(a[k]!==0){for(y=k+1;y<e;y++){v=0;for(n=k;n<c;n++)v+=x[n][k]*x[n][y];v=-v/x[k][k];for(n=k;n<c;n++)x[n][y]=x[n][y]+v*x[n][k]}for(n=k;n<c;n++)x[n][k]=-x[n][k];x[k][k]=1+x[k][k];for(n=0;n<k-1;n++)x[n][k]=0}else{for(n=0;n<c;n++)x[n][k]=0;x[k][k]=1}}if(l)for(k=f-1;k>=0;k--){if(k<u&&w[k]!==0)for(y=k+1;y<f;y++){v=0;for(n=k+1;n<f;n++)v+=p[n][k]*p[n][y];v=-v/p[k+1][k];for(n=k+1;n<f;n++)p[n][y]=p[n][y]+v*p[n][k]}for(n=0;n<f;n++)p[n][k]=0;p[k][k]=1}e=r-1;q=0;for(t=Number.EPSILON;r>
0;){for(k=r-2;k>=-1;k--){if(k===-1)break;if(Math.abs(w[k])<=t*(Math.abs(a[k])+Math.abs(a[k+1]))){w[k]=0;break}}if(k===r-2)v=4;else{for(n=r-1;n>=k;n--){if(n===k)break;v=(n!==r?Math.abs(w[n]):0)+(n!==k+1?Math.abs(w[n-1]):0);if(Math.abs(a[n])<=t*v){a[n]=0;break}}if(n===k)v=3;else if(n===r-1)v=1;else{v=2;k=n}}k++;switch(v){case 1:u=w[r-2];w[r-2]=0;for(y=r-2;y>=k;y--){v=H(a[y],u);z=a[y]/v;var A=u/v;a[y]=v;if(y!==k){u=-A*w[y-1];w[y-1]=z*w[y-1]}if(l)for(n=0;n<f;n++){v=z*p[n][y]+A*p[n][r-1];p[n][r-1]=-A*
p[n][y]+z*p[n][r-1];p[n][y]=v}}break;case 2:u=w[k-1];w[k-1]=0;for(y=k;y<r;y++){v=H(a[y],u);z=a[y]/v;A=u/v;a[y]=v;u=-A*w[y];w[y]=z*w[y];if(d)for(n=0;n<c;n++){v=z*x[n][y]+A*x[n][k-1];x[n][k-1]=-A*x[n][y]+z*x[n][k-1];x[n][y]=v}}break;case 3:y=Math.max(Math.abs(a[r-1]),Math.abs(a[r-2]),Math.abs(w[r-2]),Math.abs(a[k]),Math.abs(w[k]));n=a[r-1]/y;z=a[r-2]/y;u=w[r-2]/y;v=a[k]/y;y=w[k]/y;z=((z+n)*(z-n)+u*u)/2;u=n*u*(n*u);A=0;if(z!==0||u!==0){A=Math.sqrt(z*z+u);z<0&&(A=-A);A=u/(z+A)}u=(v+n)*(v-n)+A;var C=v*
y;for(y=k;y<r-1;y++){v=H(u,C);z=u/v;A=C/v;y!==k&&(w[y-1]=v);u=z*a[y]+A*w[y];w[y]=z*w[y]-A*a[y];C=A*a[y+1];a[y+1]=z*a[y+1];if(l)for(n=0;n<f;n++){v=z*p[n][y]+A*p[n][y+1];p[n][y+1]=-A*p[n][y]+z*p[n][y+1];p[n][y]=v}v=H(u,C);z=u/v;A=C/v;a[y]=v;u=z*w[y]+A*a[y+1];a[y+1]=-A*w[y]+z*a[y+1];C=A*w[y+1];w[y+1]=z*w[y+1];if(d&&y<c-1)for(n=0;n<c;n++){v=z*x[n][y]+A*x[n][y+1];x[n][y+1]=-A*x[n][y]+z*x[n][y+1];x[n][y]=v}}w[r-2]=u;q+=1;break;case 4:if(a[k]<=0){a[k]=a[k]<0?-a[k]:0;if(l)for(n=0;n<=e;n++)p[n][k]=-p[n][k]}for(;k<
e;){if(a[k]>=a[k+1])break;v=a[k];a[k]=a[k+1];a[k+1]=v;if(l&&k<f-1)for(n=0;n<f;n++){v=p[n][k+1];p[n][k+1]=p[n][k];p[n][k]=v}if(d&&k<c-1)for(n=0;n<c;n++){v=x[n][k+1];x[n][k+1]=x[n][k];x[n][k]=v}k++}q=0;r--}}if(m){d=p;p=x;x=d}this.m=c;this.n=f;this.s=a;this.U=x;this.V=p}solve(a){var c=this.threshold,f=this.s.length,e=K.zeros(f,f),b;for(b=0;b<f;b++)e[b][b]=Math.abs(this.s[b])<=c?0:1/this.s[b];c=this.U;b=this.rightSingularVectors;e=b.mmul(e);var h=b.rows,g=c.length,d=K.zeros(h,g),l,m,x;for(b=0;b<h;b++)for(l=
0;l<g;l++){for(m=x=0;m<f;m++)x+=e[b][m]*c[l][m];d[b][l]=x}return d.mmul(a)}solveForDiagonal(a){return this.solve(K.diag(a))}inverse(){var a=this.V,c=this.threshold,f=a.length,e=a[0].length,b=new K(f,this.s.length),h,g;for(h=0;h<f;h++)for(g=0;g<e;g++)b[h][g]=Math.abs(this.s[g])>c?a[h][g]/this.s[g]:0;a=this.U;c=a.length;e=a[0].length;var d=new K(f,c),l,m;for(h=0;h<f;h++)for(g=0;g<c;g++){for(l=m=0;l<e;l++)m+=b[h][l]*a[g][l];d[h][g]=m}return d}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-
1]}get norm2(){return this.s[0]}get rank(){for(var a=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,c=0,f=this.s,e=0,b=f.length;e<b;e++)f[e]>a&&c++;return c}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){if(!K.isMatrix(this.U))this.U=new K(this.U);return this.U}get rightSingularVectors(){if(!K.isMatrix(this.V))this.V=new K(this.V);return this.V}get diagonalMatrix(){return K.diag(this.s)}}class u extends v(){constructor(a,
c,f){super();this.matrix=a;this.rows=c;this.columns=f}static get [Symbol.species](){return K}}class D extends u{constructor(a){super(a,a.columns,a.rows)}set(a,c,f){this.matrix.set(c,a,f);return this}get(a,c){return this.matrix.get(c,a)}}class l extends u{constructor(a,c){super(a,1,a.columns);this.row=c}set(a,c,f){this.matrix.set(this.row,c,f);return this}get(a,c){return this.matrix.get(this.row,c)}}class q extends u{constructor(a,c,f,e,b){P(a,c,f,e,b);super(a,f-c+1,b-e+1);this.startRow=c;this.startColumn=
e}set(a,c,f){this.matrix.set(this.startRow+a,this.startColumn+c,f);return this}get(a,c){return this.matrix.get(this.startRow+a,this.startColumn+c)}}class L extends u{constructor(a,c,f){c=ka(a,c,f);super(a,c.row.length,c.column.length);this.rowIndices=c.row;this.columnIndices=c.column}set(a,c,f){this.matrix.set(this.rowIndices[a],this.columnIndices[c],f);return this}get(a,c){return this.matrix.get(this.rowIndices[a],this.columnIndices[c])}}class A extends u{constructor(a,c){c=x(a,c);super(a,c.length,
a.columns);this.rowIndices=c}set(a,c,f){this.matrix.set(this.rowIndices[a],c,f);return this}get(a,c){return this.matrix.get(this.rowIndices[a],c)}}class R extends u{constructor(a,c){c=m(a,c);super(a,a.rows,c.length);this.columnIndices=c}set(a,c,f){this.matrix.set(a,this.columnIndices[c],f);return this}get(a,c){return this.matrix.get(a,this.columnIndices[c])}}class z extends u{constructor(a,c){super(a,a.rows,1);this.column=c}set(a,c,f){this.matrix.set(a,this.column,f);return this}get(a){return this.matrix.get(a,
this.column)}}class O extends u{constructor(a){super(a,a.rows,a.columns)}set(a,c,f){this.matrix.set(this.rows-a-1,c,f);return this}get(a,c){return this.matrix.get(this.rows-a-1,c)}}class ba extends u{constructor(a){super(a,a.rows,a.columns)}set(a,c,f){this.matrix.set(a,this.columns-c-1,f);return this}get(a,c){return this.matrix.get(a,this.columns-c-1)}}class K extends v(Array){constructor(a,c){var f;if(arguments.length===1&&typeof a==="number")return Array(a);if(K.isMatrix(a))return a.clone();if(Number.isInteger(a)&&
a>0){super(a);if(Number.isInteger(c)&&c>0)for(f=0;f<a;f++)this[f]=Array(c);else throw new TypeError("nColumns must be a positive integer");}else if(Array.isArray(a)){const e=a;a=e.length;c=e[0].length;if(typeof c!=="number"||c===0)throw new TypeError("Data must be a 2D array with at least one element");super(a);for(f=0;f<a;f++){if(e[f].length!==c)throw new RangeError("Inconsistent array dimensions");this[f]=[].concat(e[f])}}else throw new TypeError("First argument must be a positive number or an array");
this.rows=a;this.columns=c;return this}set(a,c,f){this[a][c]=f;return this}get(a,c){return this[a][c]}removeRow(a){da(this,a);if(this.rows===1)throw new RangeError("A matrix cannot have less than one row");this.splice(a,1);--this.rows;return this}addRow(a,c){if(c===void 0){c=a;a=this.rows}da(this,a,true);c=U(this,c,true);this.splice(a,0,c);this.rows=this.rows+1;return this}removeColumn(a){V(this,a);if(this.columns===1)throw new RangeError("A matrix cannot have less than one column");for(var c=0;c<
this.rows;c++)this[c].splice(a,1);--this.columns;return this}addColumn(a,c){if(typeof c==="undefined"){c=a;a=this.columns}V(this,a,true);c=T(this,c);for(var f=0;f<this.rows;f++)this[f].splice(a,0,c[f]);this.columns=this.columns+1;return this}}class Y extends v(){constructor(a,c={}){var {rows:c=1}=c;if(a.length%c!==0)throw Error("the data length is not divisible by the number of rows");super();this.rows=c;this.columns=a.length/c;this.data=a}set(a,c,f){a=this._calculateIndex(a,c);this.data[a]=f;return this}get(a,
c){a=this._calculateIndex(a,c);return this.data[a]}_calculateIndex(a,c){return a*this.columns+c}static get [Symbol.species](){return K}}class S extends v(){constructor(a){super();this.data=a;this.rows=a.length;this.columns=a[0].length}set(a,c,f){this.data[a][c]=f;return this}get(a,c){return this.data[a][c]}static get [Symbol.species](){return K}}class aa{constructor(a){a=S.checkMatrix(a);var c=a.clone(),f=a.rows;a=a.columns;var e=Array(a),b,h,g;for(g=0;g<a;g++){var d=0;for(b=g;b<f;b++)d=H(d,c.get(b,
g));if(d!==0){c.get(g,g)<0&&(d=-d);for(b=g;b<f;b++)c.set(b,g,c.get(b,g)/d);c.set(g,g,c.get(g,g)+1);for(h=g+1;h<a;h++){var l=0;for(b=g;b<f;b++)l+=c.get(b,g)*c.get(b,h);l=-l/c.get(g,g);for(b=g;b<f;b++)c.set(b,h,c.get(b,h)+l*c.get(b,g))}}e[g]=-d}this.QR=c;this.Rdiag=e}solve(a){a=K.checkMatrix(a);var c=this.QR,f=c.rows;if(a.rows!==f)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");var e=a.columns;a=a.clone();var b=c.columns,h,d,l;for(l=0;l<
b;l++)for(d=0;d<e;d++){var m=0;for(h=l;h<f;h++)m+=c[h][l]*a[h][d];m=-m/c[l][l];for(h=l;h<f;h++)a[h][d]=a[h][d]+m*c[h][l]}for(l=b-1;l>=0;l--){for(d=0;d<e;d++)a[l][d]=a[l][d]/this.Rdiag[l];for(h=0;h<l;h++)for(d=0;d<e;d++)a[h][d]=a[h][d]-a[l][d]*c[h][l]}return a.subMatrix(0,b-1,0,e-1)}isFullRank(){for(var a=this.QR.columns,c=0;c<a;c++)if(this.Rdiag[c]===0)return false;return true}get upperTriangularMatrix(){var a=this.QR,c=a.columns,f=new K(c,c),e,b;for(e=0;e<c;e++)for(b=0;b<c;b++)f[e][b]=e<b?a[e][b]:
e===b?this.Rdiag[e]:0;return f}get orthogonalMatrix(){var a=this.QR,c=a.rows,f=a.columns,e=new K(c,f),b,d,g;for(g=f-1;g>=0;g--){for(b=0;b<c;b++)e[b][g]=0;e[g][g]=1;for(d=g;d<f;d++)if(a[g][g]!==0){var l=0;for(b=g;b<c;b++)l+=a[b][g]*e[b][d];l=-l/a[g][g];for(b=g;b<c;b++)e[b][d]=e[b][d]+l*a[b][g]}}return e}}class pa{constructor(a,c={}){var {assumeSymmetric:f=false}=c;a=S.checkMatrix(a);if(!a.isSquare())throw Error("Matrix is not a square matrix");c=a.columns;var e=ia(c,c,0),b=Array(c),d=Array(c),g=a;
if(f||a.isSymmetric()){for(a=0;a<c;a++)for(f=0;f<c;f++)e[a][f]=g.get(a,f);C(c,d,b,e);la(c,d,b,e)}else{var l=ia(c,c,0),m=Array(c);for(f=0;f<c;f++)for(a=0;a<c;a++)l[a][f]=g.get(a,f);ca(c,l,m,e);M(c,d,b,e,l)}this.n=c;this.e=d;this.d=b;this.V=e}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){if(!K.isMatrix(this.V))this.V=new K(this.V);return this.V}get diagonalMatrix(){var a=this.n,c=this.e,f=this.d,e=new K(a,a),b,d;for(b=0;b<a;b++){for(d=0;d<a;d++)e[b][d]=
0;e[b][b]=f[b];c[b]>0?e[b][b+1]=c[b]:c[b]<0&&(e[b][b-1]=c[b])}return e}}class qa{constructor(a){a=S.checkMatrix(a);if(!a.isSymmetric())throw Error("Matrix is not symmetric");var c=a.rows,f=new K(c,c),e=true,b,d,g;for(d=0;d<c;d++){var l=f[d],m=0;for(g=0;g<d;g++){var x=f[g],q=0;for(b=0;b<g;b++)q+=x[b]*l[b];l[g]=q=(a.get(d,g)-q)/f[g][g];m+=q*q}m=a.get(d,d)-m;e&=m>0;f[d][d]=Math.sqrt(Math.max(m,0));for(g=d+1;g<c;g++)f[d][g]=0}if(!e)throw Error("Matrix is not positive definite");this.L=f}solve(a){a=S.checkMatrix(a);
var c=this.L,f=c.rows;if(a.rows!==f)throw Error("Matrix dimensions do not match");var e=a.columns;a=a.clone();var b,d,g;for(g=0;g<f;g++)for(d=0;d<e;d++){for(b=0;b<g;b++)a[g][d]=a[g][d]-a[b][d]*c[g][b];a[g][d]=a[g][d]/c[g][g]}for(g=f-1;g>=0;g--)for(d=0;d<e;d++){for(b=g+1;b<f;b++)a[g][d]=a[g][d]-a[b][d]*c[b][g];a[g][d]=a[g][d]/c[g][g]}return a}get lowerTriangularMatrix(){return this.L}}d["default"]=K;d.Matrix=K;d.abstractMatrix=v;d.wrap=function e(c,d){if(Array.isArray(c))return c[0]&&Array.isArray(c[0])?
new S(c):new Y(c,d);throw Error("the argument is not an array");};d.WrapperMatrix2D=S;d.WrapperMatrix1D=Y;d.solve=F;d.inverse=function b(d,e=false){d=S.checkMatrix(d);return e?(new G(d)).inverse():F(d,K.eye(d.rows))};d.SingularValueDecomposition=G;d.SVD=G;d.EigenvalueDecomposition=pa;d.EVD=pa;d.CholeskyDecomposition=qa;d.CHO=qa;d.LuDecomposition=E;d.LU=E;d.QrDecomposition=aa;d.QR=aa},{"ml-array-rescale":2}],2:[function(Z,ha,d){function H(d){return d&&typeof d==="object"&&"default"in d?d["default"]:
d}var ia=H(Z("ml-array-max")),da=H(Z("ml-array-min"));ha.exports=function ka(d,T={}){if(!Array.isArray(d))throw new TypeError("input must be an array");if(d.length===0)throw new TypeError("input must not be empty");if(T.output!==void 0){if(!Array.isArray(T.output))throw new TypeError("output option must be an array if specified");T=T.output}else T=Array(d.length);const x=da(d);var m=ia(d);if(x===m)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");
const {min:P=T.autoMinMax?x:0,max:J=T.autoMinMax?m:1}=T;if(P>=J)throw new RangeError("min option must be smaller than max option");m=(J-P)/(m-x);for(var W=0;W<d.length;W++)T[W]=(d[W]-x)*m+P;return T}},{"ml-array-max":3,"ml-array-min":4}],3:[function(Z,ha,d){ha.exports=function da(d){if(!Array.isArray(d))throw Error("input must be an array");if(d.length===0)throw Error("input must not be empty");for(var V=d[0],U=1;U<d.length;U++)d[U]>V&&(V=d[U]);return V}},{}],4:[function(Z,ha,d){ha.exports=function da(d){if(!Array.isArray(d))throw Error("input must be an array");
if(d.length===0)throw Error("input must not be empty");for(var V=d[0],U=1;U<d.length;U++)d[U]<V&&(V=d[U]);return V}},{}],5:[function(Z,ha,d){function H(d,da){return d-da}d.sum=function V(d){for(var U=0,T=0;T<d.length;T++)U+=d[T];return U};d.max=function U(d){for(var T=d[0],V=d.length,x=1;x<V;x++)d[x]>T&&(T=d[x]);return T};d.min=function T(d){for(var U=d[0],x=d.length,m=1;m<x;m++)d[m]<U&&(U=d[m]);return U};d.minMax=function ka(d){for(var x=d[0],m=d[0],P=d.length,J=1;J<P;J++){d[J]<x&&(x=d[J]);d[J]>
m&&(m=d[J])}return{min:x,max:m}};d.arithmeticMean=function x(d){for(var m=0,P=d.length,J=0;J<P;J++)m+=d[J];return m/P};d.mean=d.arithmeticMean;d.geometricMean=function m(d){for(var x=1,J=d.length,W=0;W<J;W++)x*=d[W];return Math.pow(x,1/J)};d.logMean=function P(d){for(var m=0,W=d.length,N=0;N<W;N++)m+=Math.log(d[N]);return m/W};d.grandMean=function W(d,J){for(var P=0,v=0,F=d.length,C=0;C<F;C++){P+=J[C]*d[C];v+=J[C]}return P/v};d.truncatedMean=function v(d,W,N){N===void 0&&(N=false);N||(d=[].concat(d).sort(H));
N=d.length;W=Math.floor(N*W);for(var F=0,C=W;C<N-W;C++)F+=d[C];return F/(N-2*W)};d.harmonicMean=function N(d){for(var v=0,F=d.length,C=0;C<F;C++){if(d[C]===0)throw new RangeError("value at index "+C+"is zero");v+=1/d[C]}return F/v};d.contraHarmonicMean=function v(d){for(var F=0,C=0,N=d.length,ca=0;ca<N;ca++){F+=d[ca]*d[ca];C+=d[ca]}if(C<0)throw new RangeError("sum of values is negative");return F/C};d.median=function C(d,F){F===void 0&&(F=false);F||(d=[].concat(d).sort(H));F=d.length;var v=Math.floor(F/
2);return F%2===0?(d[v-1]+d[v])*.5:d[v]};d.variance=function la(F,C){C===void 0&&(C=true);for(var ca=d.mean(F),M=0,r=F.length,I=0;I<r;I++){var E=F[I]-ca;M+=E*E}return C?M/(r-1):M/r};d.standardDeviation=function ca(C,la){return Math.sqrt(d.variance(C,la))};d.standardError=function ca(la){return d.standardDeviation(la)/Math.sqrt(la.length)};d.robustMeanAndStdev=function M(d){var r=0,I=d.length,E;for(E=0;E<I;E++)r+=d[E];r/=I;var G=Array(I);for(E=0;E<I;E++)G[E]=Math.abs(d[E]-r);G.sort(H);return{mean:r,
stdev:I%2===1?G[(I-1)/2]/.6745:.5*(G[I/2]+G[I/2-1])/.6745}};d.quartiles=function I(M,r){typeof r==="undefined"&&(r=false);r||(M=[].concat(M).sort(H));r=M.length/4;var E=M[Math.ceil(r)-1],G=d.median(M,true);return{q1:E,q2:G,q3:M[Math.ceil(r*3)-1]}};d.pooledStandardDeviation=function E(r,I){return Math.sqrt(d.pooledVariance(r,I))};d.pooledVariance=function G(I,E){typeof E==="undefined"&&(E=true);for(var u=0,D=0,l=I.length,q=0;q<l;q++){var L=I[q],A=d.variance(L);u+=(L.length-1)*A;D=E?D+(L.length-1):
D+L.length}return u/D};d.mode=function G(d){var u=d.length,D=Array(u),l;for(l=0;l<u;l++)D[l]=0;var q=Array(u),E=0;for(l=0;l<u;l++){var A=q.indexOf(d[l]);if(A>=0)D[A]++;else{q[E]=d[l];D[E]=1;E++}}for(l=u=d=0;l<E;l++)if(D[l]>d){d=D[l];u=l}return q[u]};d.covariance=function l(G,u,D){typeof D==="undefined"&&(D=true);var q=d.mean(G),L=d.mean(u);if(G.length!==u.length)throw"Vectors do not have the same dimensions";for(var A=0,R=G.length,z=0;z<R;z++)A+=(G[z]-q)*(u[z]-L);return D?A/(R-1):A/R};d.skewness=
function l(u,D){typeof D==="undefined"&&(D=true);for(var q=d.mean(u),L=0,A=0,R=u.length,z=0;z<R;z++){var O=u[z]-q;L+=O*O;A+=O*O*O}u=A/R/Math.pow(L/R,1.5);return D?Math.sqrt(R*(R-1))/(R-2)*u:u};d.kurtosis=function q(D,l){typeof l==="undefined"&&(l=true);for(var L=d.mean(D),A=D.length,R=0,z=0,O=0;O<A;O++){var ba=D[O]-L;R+=ba*ba;z+=ba*ba*ba*ba}D=R/A;if(l){l=R/(A-1);return A*(A+1)/((A-1)*(A-2)*(A-3))*(z/(l*l))-3*((A-1)*(A-1)/((A-2)*(A-3)))}return z/A/(D*D)-3};d.entropy=function L(d,q){typeof q==="undefined"&&
(q=0);for(var l=0,R=d.length,z=0;z<R;z++)l+=d[z]*Math.log(d[z]+q);return-l};d.weightedMean=function A(d,L){for(var q=0,z=d.length,O=0;O<z;O++)q+=d[O]*L[O];return q};d.weightedStandardDeviation=function R(L,A){return Math.sqrt(d.weightedVariance(L,A))};d.weightedVariance=function z(A,R){for(var O=d.weightedMean(A,R),ba=0,K=A.length,Y=0,S=0,aa=0;aa<K;aa++){var H=A[aa]-O,Z=R[aa];ba+=Z*(H*H);S+=Z;Y+=Z*Z}return ba*(S/(S*S-Y))};d.center=function O(R,z){typeof z==="undefined"&&(z=false);var ba=R;z||(ba=
[].concat(R));R=d.mean(ba);z=ba.length;for(var K=0;K<z;K++)ba[K]=ba[K]-R};d.standardize=function K(z,O,ba){typeof O==="undefined"&&(O=d.standardDeviation(z));typeof ba==="undefined"&&(ba=false);var Y=z.length;ba=ba?z:Array(Y);for(var S=0;S<Y;S++)ba[S]=z[S]/O;return ba};d.cumulativeSum=function ba(d){var K=d.length,O=Array(K);O[0]=d[0];for(var S=1;S<K;S++)O[S]=O[S-1]+d[S];return O}},{}],6:[function(Z,ha,d){function H(d,V){return d-V}var ia=Z("./array");d.max=function U(d){for(var T=-Infinity,V=0;V<
d.length;V++)for(var x=0;x<d[V].length;x++)d[V][x]>T&&(T=d[V][x]);return T};d.min=function T(d){for(var U=Infinity,x=0;x<d.length;x++)for(var m=0;m<d[x].length;m++)d[x][m]<U&&(U=d[x][m]);return U};d.minMax=function ka(d){for(var x=Infinity,m=-Infinity,P=0;P<d.length;P++)for(var J=0;J<d[P].length;J++){d[P][J]<x&&(x=d[P][J]);d[P][J]>m&&(m=d[P][J])}return{min:x,max:m}};d.entropy=function m(d,x){typeof x==="undefined"&&(x=0);for(var P=0,J=d.length,W=d[0].length,N=0;N<J;N++)for(var v=0;v<W;v++)P+=d[N][v]*
Math.log(d[N][v]+x);return-P};d.mean=function P(d,m){typeof m==="undefined"&&(m=0);var x=d.length,W=d[0].length,N,v;if(m===-1){m=[0];var F=x*W;for(N=0;N<x;N++)for(v=0;v<W;v++)m[0]=m[0]+d[N][v];m[0]=m[0]/F}else if(m===0){m=Array(W);F=x;for(v=0;v<W;v++){for(N=m[v]=0;N<x;N++)m[v]=m[v]+d[N][v];m[v]=m[v]/F}}else if(m===1){m=Array(x);F=W;for(v=0;v<x;v++){for(N=m[v]=0;N<W;N++)m[v]=m[v]+d[v][N];m[v]=m[v]/F}}else throw Error("Invalid dimension");return m};d.sum=function J(d,P){typeof P==="undefined"&&(P=0);
var m=d.length,N=d[0].length,v,F;if(P===-1){P=[0];for(v=0;v<m;v++)for(F=0;F<N;F++)P[0]=P[0]+d[v][F]}else if(P===0){P=Array(N);for(F=0;F<N;F++)for(v=P[F]=0;v<m;v++)P[F]=P[F]+d[v][F]}else if(P===1){P=Array(m);for(F=0;F<m;F++)for(v=P[F]=0;v<N;v++)P[F]=P[F]+d[F][v]}else throw Error("Invalid dimension");return P};d.product=function W(d,J){typeof J==="undefined"&&(J=0);var P=d.length,v=d[0].length,F,C;if(J===-1){J=[1];for(F=0;F<P;F++)for(C=0;C<v;C++)J[0]=J[0]*d[F][C]}else if(J===0){J=Array(v);for(C=0;C<
v;C++){J[C]=1;for(F=0;F<P;F++)J[C]=J[C]*d[F][C]}}else if(J===1){J=Array(P);for(C=0;C<P;C++){J[C]=1;for(F=0;F<v;F++)J[C]=J[C]*d[C][F]}}else throw Error("Invalid dimension");return J};d.standardDeviation=function v(J,W,N){J=d.variance(J,W,N);W=J.length;for(N=0;N<W;N++)J[N]=Math.sqrt(J[N]);return J};d.variance=function F(W,N,v){typeof v==="undefined"&&(v=true);N=N||d.mean(W);var C=W.length;if(C===0)return[];for(var H=W[0].length,ca=Array(H),M=0;M<H;M++){for(var r=0,I=0,E,G=0;G<C;G++){E=W[G][M]-N[M];
r+=E;I+=E*E}ca[M]=v?(I-r*r/C)/(C-1):(I-r*r/C)/C}return ca};d.median=function v(d){for(var F=d.length,C=d[0].length,N=Array(C),ca=0;ca<C;ca++){for(var M=Array(F),r=0;r<F;r++)M[r]=d[r][ca];M.sort(H);r=M.length;N[ca]=r%2===0?(M[r/2]+M[r/2-1])*.5:M[Math.floor(r/2)]}return N};d.mode=function F(d){var v=d.length,H=d[0].length,ca=Array(H),M,r;for(M=0;M<H;M++){var I=Array(v);for(r=0;r<v;r++)I[r]=0;var E=Array(v),G=0;for(r=0;r<v;r++){var u=E.indexOf(d[r][M]);if(u>=0)I[u]++;else{E[G]=d[r][M];I[G]=1;G++}}var D=
u=0;for(r=0;r<G;r++)if(I[r]>u){u=I[r];D=r}ca[M]=E[D]}return ca};d.skewness=function la(F,C){typeof C==="undefined"&&(C=true);for(var H=d.mean(F),M=F.length,r=H.length,I=Array(r),E=0;E<r;E++){for(var G=0,u=0,D=0;D<M;D++){var l=F[D][E]-H[E];G+=l*l;u+=l*l*l}G=u/M/Math.pow(G/M,1.5);I[E]=C?Math.sqrt(M*(M-1))/(M-2)*G:G}return I};d.kurtosis=function ca(C,H){typeof H==="undefined"&&(H=true);for(var M=d.mean(C),r=C.length,I=C[0].length,E=Array(I),G=0;G<I;G++){for(var u=0,D=0,l=0;l<r;l++){var q=C[l][G]-M[G];
u+=q*q;D+=q*q*q*q}l=u/r;q=D/r;if(H){u/=r-1;E[G]=r*(r+1)/((r-1)*(r-2)*(r-3))*(D/(u*u))-3*((r-1)*(r-1)/((r-2)*(r-3)))}else E[G]=q/(l*l)-3}return E};d.standardError=function ca(H){var M=H.length;H=d.standardDeviation(H);var r=H.length,I=Array(r);M=Math.sqrt(M);for(var E=0;E<r;E++)I[E]=H[E]/M;return I};d.covariance=function r(H,M){return d.scatter(H,void 0,M)};d.scatter=function E(M,r,I){typeof I==="undefined"&&(I=0);typeof r==="undefined"&&(I===0?r=M.length-1:I===1&&(r=M[0].length-1));var G=d.mean(M,
I),u=M.length;if(u===0)return[[]];var D=M[0].length,l,q,L,A;if(I===0){I=Array(D);for(l=0;l<D;l++)I[l]=Array(D);for(l=0;l<D;l++)for(q=l;q<D;q++){for(A=L=0;A<u;A++)L+=(M[A][q]-G[q])*(M[A][l]-G[l]);L/=r;I[l][q]=L;I[q][l]=L}}else if(I===1){I=Array(u);for(l=0;l<u;l++)I[l]=Array(u);for(l=0;l<u;l++)for(q=l;q<u;q++){for(A=L=0;A<D;A++)L+=(M[q][A]-G[q])*(M[l][A]-G[l]);L/=r;I[l][q]=L;I[q][l]=L}}else throw Error("Invalid dimension");return I};d.correlation=function I(r){var E=d.mean(r),G=d.standardDeviation(r,
true,E);E=d.zScores(r,E,G);G=r.length;r=r[0].length;var u,D,l=Array(r);for(u=0;u<r;u++)l[u]=Array(r);for(u=0;u<r;u++)for(D=u;D<r;D++){for(var q=0,L=0,A=E.length;L<A;L++)q+=E[L][D]*E[L][u];q/=G-1;l[u][D]=q;l[D][u]=q}return l};d.zScores=function u(I,E,G){E=E||d.mean(I);typeof G==="undefined"&&(G=d.standardDeviation(I,true,E));return d.standardize(d.center(I,E,false),G,true)};d.center=function D(E,G,u){G=G||d.mean(E);var l=E,q=E.length,L;if(!u){l=Array(q);for(u=0;u<q;u++)l[u]=Array(E[u].length)}for(u=
0;u<q;u++){var A=l[u];var R=0;for(L=A.length;R<L;R++)A[R]=E[u][R]-G[R]}return l};d.standardize=function l(G,u,D){typeof u==="undefined"&&(u=d.standardDeviation(G));var q=G,L=G.length,A;if(!D){q=Array(L);for(D=0;D<L;D++)q[D]=Array(G[D].length)}for(D=0;D<L;D++){var R=q[D],z=G[D];var O=0;for(A=R.length;O<A;O++)u[O]===0||isNaN(u[O])||(R[O]=z[O]/u[O])}return q};d.weightedVariance=function l(u,D){var q=d.mean(u),L=u.length;if(L===0)return[];for(var A=u[0].length,R=Array(A),z=0;z<A;z++){for(var O=0,H=0,
K=0,Y=0;Y<L;Y++){var S=u[Y][z]-q[z],aa=D[Y];O+=aa*(S*S);K+=aa;H+=aa*aa}R[z]=O*(K/(K*K-H))}return R};d.weightedMean=function L(d,l,q){typeof q==="undefined"&&(q=0);var A=d.length;if(A===0)return[];var D=d[0].length,z,O;if(q===0){q=Array(D);for(z=0;z<D;z++)q[z]=0;for(z=0;z<A;z++){var H=d[z];var K=l[z];for(O=0;O<D;O++)q[O]=q[O]+H[O]*K}}else if(q===1){q=Array(A);for(z=0;z<A;z++)q[z]=0;for(O=0;O<A;O++){H=d[O];K=l[O];for(z=0;z<D;z++)q[O]=q[O]+H[z]*K}}else throw Error("Invalid dimension");l=ia.sum(l);if(l!==
0){z=0;for(d=q.length;z<d;z++)q[z]=q[z]/l}return q};d.weightedCovariance=function R(l,q,H,A){A=A||0;H=H||d.weightedMean(l,q,A);for(var z=0,O=0,L=0,K=q.length;L<K;L++){z+=q[L];O+=q[L]*q[L]}return d.weightedScatter(l,q,H,z/(z*z-O),A)};d.weightedScatter=function O(q,H,A,R,z){z=z||0;A=A||d.weightedMean(q,H,z);typeof R==="undefined"&&(R=1);var L=q.length;if(L===0)return[[]];var K=q[0].length,Y,S,aa,Z;if(z===0){z=Array(K);for(Y=0;Y<K;Y++)z[Y]=Array(K);for(Y=0;Y<K;Y++)for(S=Y;S<K;S++){for(aa=Z=0;aa<L;aa++)Z+=
H[aa]*(q[aa][S]-A[S])*(q[aa][Y]-A[Y]);z[Y][S]=Z*R;z[S][Y]=Z*R}}else if(z===1){z=Array(L);for(Y=0;Y<L;Y++)z[Y]=Array(L);for(Y=0;Y<L;Y++)for(S=Y;S<L;S++){for(aa=Z=0;aa<K;aa++)Z+=H[aa]*(q[S][aa]-A[S])*(q[Y][aa]-A[Y]);z[Y][S]=Z*R;z[S][Y]=Z*R}}else throw Error("Invalid dimension");return z}},{"./array":5}],7:[function(Z,ha,d){d=Z("ml-matrix");const H=d.Matrix,ia=d.EVD,da=d.SVD;Z=Z("ml-stat/matrix");const V=Z.mean,U=Z.standardDeviation,T={isCovarianceMatrix:false,center:true,scale:false};class ka{constructor(d,
m){if(d===true){d=m;this.center=d.center;this.scale=d.scale;this.means=d.means;this.stdevs=d.stdevs;this.U=H.checkMatrix(d.U);this.S=d.S}else{m=Object.assign({},T,m);this.scale=this.center=false;this.stdevs=this.means=null;if(m.isCovarianceMatrix)this._computeFromCovarianceMatrix(d);else if(typeof m.useCovarianceMatrix==="boolean"?m.useCovarianceMatrix:d.length>d[0].length){d=this._adjust(d,m);d=d.transposeView().mmul(d).div(d.rows-1);this._computeFromCovarianceMatrix(d)}else{d=this._adjust(d,m);
m=new da(d,{computeLeftSingularVectors:false,computeRightSingularVectors:true,autoTranspose:true});this.U=m.rightSingularVectors;const x=m.diagonal,H=Array(x.length);for(m=0;m<x.length;m++)H[m]=x[m]*x[m]/(d.length-1);this.S=H}}}static load(d){if(d.name!=="PCA")throw new RangeError("Invalid model: "+d.name);return new ka(true,d)}predict(d,m={}){var {nComponents:m=this.U.columns}=m;d=new H(d);if(this.center){d.subRowVector(this.means);this.scale&&d.divRowVector(this.stdevs)}d=d.mmul(this.U);return d.subMatrix(0,
d.rows-1,0,m-1)}getExplainedVariance(){for(var d=0,m=0;m<this.S.length;m++)d+=this.S[m];return this.S.map((m)=>m/d)}getCumulativeVariance(){for(var d=this.getExplainedVariance(),m=1;m<d.length;m++)d[m]=d[m]+d[m-1];return d}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map((d)=>Math.sqrt(d))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S}}_adjust(d,
m){this.center=!!m.center;this.scale=!!m.scale;d=new H(d);if(this.center){var x=V(d);m=this.scale?U(d,x,true):null;this.means=x;d.subRowVector(x);if(this.scale){for(x=0;x<m.length;x++)if(m[x]===0)throw new RangeError("Cannot scale the dataset (standard deviation is zero at index "+x);this.stdevs=m;d.divRowVector(m)}}return d}_computeFromCovarianceMatrix(d){d=new ia(d,{assumeSymmetric:true});this.U=d.eigenvectorMatrix;for(var m=0;m<this.U.length;m++)this.U[m].reverse();this.S=d.realEigenvalues.reverse()}}
ha.exports=ka},{"ml-matrix":1,"ml-stat/matrix":6}]},{},[7])(7)});
